# This function will be the starting point for processing the logistic regression equations for riparian vegetation
# Last edited by Elaina Passero on 11/20/19

veg_list <- c("tall_trees","drgt_tol_shrubs")

historic_ep_map <- scene_veg_out$hydrograph$ep_map # load EP map


all_veg_pref <- fread(paste(reach_wd,"habitat_info","/",reach_name,"_veg_pref",".csv",sep=""),
                      header=TRUE, sep = ",",data.table = FALSE) # load substrate requirements

tall_trees <- all_veg_pref %>%
  select(tall_trees)

# each variable becomes its own object
nums <- seq(1:(length(tall_trees$tall_trees)-1))
vars <- paste("B",(nums-1),sep="")
for(i in 1:length(nums)){
  assign(vars[i],as.numeric(tall_trees[i+1,])) 
}

# create list of variables and their values
var_vals <- list()
for(i in 1:length(nums)){
  var_vals[[i]] <- as.numeric(tall_trees[i+1,]) # each variable becomes its own object
}
names(var_vals) <- vars



chr <- paste("P ~ ",tall_trees[1,1])
chr <- tall_trees[1,1]
test_expr <- as.expression(eval(as.formula(chr)))
eval(test_expr)

veg_expr <- expression(noquote(tall_trees[1,1]))
eval(veg_expr,var_vals)

# need to sub in all of the values for the variables into the expression

for(i in 1:length(var_vals)){
  chr <- gsub(vars[i],var_vals[i],chr)
}
as.formula(chr)

# evaluate the equation at each EP value
for(i in 1:length(build_x$x)){
  x <- build_x$x[i]
  chr_x <- gsub("*x",paste("*",x,sep=""),chr,fixed=TRUE)
  build_x$prob_v[i] <- eval(parse(text=chr_x))
}



